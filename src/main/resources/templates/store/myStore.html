<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="/css/storeInfo.css">
<style>
		.tabnav {
			font-size: 0;
			border: 1px solid #ddd;
		}

		.tabnav li {
			display: inline-block;
			height: 46px;
			text-align: center;
			border-right: 1px solid #ddd;
		}

		.tabnav li a:before {
			content: "";
			position: absolute;
			left: 0;
			top: 0px;
			width: 100%;
			height: 3px;
		}

		.tabnav li a.active:before {
			background: #72B37E;
		}

		.tabnav li a.active {
			border-bottom: 1px solid #fff;
		}

		.tabnav li a {
			position: relative;
			display: block;
			background: #f8f8f8;
			color: #000;
			padding: 0 30px;
			line-height: 46px;
			text-decoration: none;
			font-size: 16px;
		}

		.tabnav li a:hover,
		.tabnav li a.active {
			background: #fff;
			color: #72B37E;
		}

		.tabcontent {
			padding: 40px;
			border: 1px solid #ddd;
			border-top: none;
		}
		.tabcontent img{
			width: 35%;
			padding-bottom: 10px;
		}
		.s-storeInfo{
    		padding: 80px;
    		width: 800px;
    		box-sizing: border-box;
    		margin: 0 auto;
		}
		.s-info-wrap{
    		padding: 15px;
		}
		.s-info-wrap>div:first-child{
		    margin-bottom: 10px;
		}
		.s-info {
		    width: 100%;
		    padding: 0.5rem;
		    background-color: #fff;
		    outline: none;
		    border: 1px solid #ccc;
		    box-sizing: border-box;
		    height: 35px;
		    font-size: 14px;
		}
		.s-storeInfo th{
		    height: 40px;
		    text-align: right;
		    font-weight: 500;
		}
		.s-storeInfo td{
		    padding-left: 10px;
		    text-align: left;
		}
		.tabcontent table{
			padding: 0.5rem;
    		background-color: #fff;
    		outline: none;
    		border: 1px solid #ccc;
    		box-sizing: border-box;
    		width: 100%;
		}
		.menuInfo{
			border: 1px solid #ccc;
			height: 80px;
		}
		.goStore{
    		background-color: #72B37E;
		    color: #fff;
		    font-size: 15px;
		    border-radius: 5px;
		    text-align: center;
		    border: none;
		    cursor: pointer;
		    width: 80px;
		    height: 40px;
		    line-height: 40px;
		    float:right;
		    margin :10px;
		}
		.store-status{
			text-align: right;
			margin-bottom: 5px;
			font-weight: 700;
			font-size: 15px;
		}
		.menuShow{
			font-size: 18px;
			padding-right: 2px;
		}
		.s-storeInfo th {
			padding-right: 10px;
		}
		.s-lastTh{
			padding-top: 3px;
			padding-bottom: 3px;
		}
</style>
</head>
<body>
	<!-- 매장만 들어갈 수 있도록 하기-->
	<th:block th:include="common/header"></th:block>
	<div class="s-content">
		<div class="s-storeInfo">
			<div th:if="${store.storeStatus==1}" class="store-status" style="color:#72B37E;">[등록완료]</div>
			<div th:if="${store.storeStatus==2}" class="store-status" style="color:#FF9436;">[등록대기중]</div>
			<ul class="tabnav">
				<li><a href="#tab01">매장</a></li>
				<li><a href="#tab02">메뉴</a></li>
			</ul>
			<div class="tabcontent">
				<div id="tab01">
					<div style="text-align: center;">
						<img th:src="${store.storeImg}">			
					</div>
					<div>
					<table>
						<tr>
							<th style="width: 20%;">사업자번호  :</th>
							<td th:text="${store.businessNo}"></td>
						</tr>
						<tr>
							<th>매장명 :</th>
							<td th:text="${store.storeName}"></td>
						</tr>
						<tr>
							<th>음식타입 :</th>
							<td th:text="${store.foodType}"></td>
						</tr>
						<tr>
							<th>주변역 :</th>
							<td th:text="${store.subwayName}"></td>
						</tr>
						<tr>
							<th>주소 :</th>
							<td th:text="${addr}"></td>
						</tr>
						<tr>
							<th>연락처 :</th>
							<td th:text="${store.storePhone}"></td>
						</tr>
						<tr>
							<th>영업시간 :</th>
							<td>
								<span th:text="${store.openingHour}"></span>
								<span>부터</span>
								<span th:text="${store.closingHour}"></span>
								<span>까지</span>
							</td>
						</tr>
						<tr>
							<th>쉬는시간 :</th>
							<td>
								<th:block th:if="${store.breakStart=='-1'}">
									<span>없음</span>
								</th:block>
								<th:block th:if="${store.breakStart!='-1'}">
									<span th:text="${store.breakStart}"></span>
									<span>부터</span>
									<span th:text="${store.breakEnd}"></span>
									<span>까지</span>
								</th:block>
							</td>
						</tr>
						<tr>
							<th>휴무일 :</th>
							<td>
								<th:block th:each = "day : ${closedDayList}">
									<span th:text="${day.closedDay}"></span>
								</th:block>							
							</td>
						</tr>
						<tr>
							<th>식사시간 :</th>
							<th:block th:switch="${store.timeToEat}">
								<td th:case="1">30분</td>
								<td th:case="2">1시간</td>
								<td th:case="3">1시간30분</td>
								<td th:case="4">2시간</td>								
							</th:block>	

						</tr>
						<tr>
							<th>홈페이지 :</th>
							<td th:text="${store.homePage}"></td>
						</tr>
						<tr>
							<th>SNS :</th>
							<td th:text="${store.storeSns}"></td>
						</tr>
						<tr>
							<th >매장설명 :</th>
							<td th:text="${store.storeDescription}"></td>
						</tr>
						<tr>
							<th>테이블수 :</th>
							<td>
								<span>1인용 식탁 <span th:text="${tableCapacitys[0]}"></span>개, </span><span>2인용 식탁 <span th:text="${tableCapacitys[1]}"></span>개, </span><span>3인용 식탁 <span th:text="${tableCapacitys[2]}"></span>개
							</td>
						</tr>
						<tr>
							<th></th>
							<td>
								<span>4인용 식탁 <span th:text="${tableCapacitys[3]}"></span>개, </span> <span>5인용 식탁 <span th:text="${tableCapacitys[4]}"></span>개,</span> <span>6인용 식탁 <span th:text="${tableCapacitys[5]}"></span>개,</span>
							</td>
						</tr>
						<tr>
							<th></th>
							<td>
								<span>7인용 식탁 <span th:text="${tableCapacitys[6]}"></span>개</span>, </span> <span>8인용 식탁 <span th:text="${tableCapacitys[7]}"></span>개</span>
							</td>
						</tr>				
						<tr>
							<th colspan="2" class="s-lastTh">
								<a href="/store/storedelete" class="goStore" style="background-color: #F15F5F;">삭제하기</a>
								<a th:href="@{'/store/storeUpdateFrm?storeNo=' + ${store.storeNo}}" class="goStore" style="background-color: #FFA648">수정하기</a>
								<a th:if="${store.storeStatus==1}" href="#" class="goStore">매장가기</a>	<!-- 매장상세링크 걸어줘야함 -->
							</th>
						</tr>
					</table>
					</div>
				</div>
				<div id="tab02">
					<div style="text-align: right;">
						<a href="javascript:void(0)" class="plusMenu menuShow">추가</a>					
					</div>
					
					<th:block th:each = "menu : ${menuList}">
						<div class="menuBox" style="border: 1px solid #ccc">
							<div>
                            	<img th:src="'/store/menu/'+${menu.menuImg}" class="s-img-view" width="100px" height="100px">
                         	</div>
                         	<div>
                            	<input type="hidden" th:value="${menu.menuNo}">
                               	<input type="file" name="menuImgFile" accept=".jpg,.png,.jpeg">
                                <input type="text" class="s-menu-input" th:value="${menu.menuName}" required>
                                <input type="text" class="s-menu-input" th:value="${menu.menuPrice}" required>
                            </div>
                            <div>
                            	<a href="javascript:void(0)" class="minusMenu updateMenu" th:onclick="updateMenu(this,[[${menu.storeNo}]],[[${menu.menuNo}]])">수정</a>
								<a href="javascript:void(0)" class="minusMenu" th:onclick="deleteMenu(this,[[${menu.storeNo}]],[[${menu.menuNo}]])">삭제</a>
                            </div>
                        </div>  
                    </th:block>	
			    </div>
			</div>
		</div>
	</div>
	<script th:inline="javascript">
		$(function () {
			$('.tabcontent > div').hide();
			$('.tabnav a').click(function () {
				$('.tabcontent > div').hide().filter(this.hash).fadeIn();
				$('.tabnav a').removeClass('active');
				$(this).addClass('active');
				return false;
			}).filter(':eq(0)').click();
		});
		
		function updateMenu(obj,storeNo,menuNo){
			
		}
		
		
		function deleteMenu(obj,storeNo,menuNo){
			 if (confirm("정말로 삭제하시겠습니까?")) {
			$.ajax({
				url : "/store/deleteMenu",
				type : "get",
				data : {storeNo : storeNo, menuNo : menuNo},
				success : function(data){
					if(data==1){
						console.log("삭제완료");
						$(obj).parent().parent().remove();				
					}else{
						console.log("실패");						
					}
				},
				error:function(){
					console.log("실패");
				}
			});
			 }
		}
		
		
	</script>
    <th:block th:include="common/footer"></th:block>
</body>
</html>